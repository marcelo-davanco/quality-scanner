# Gitleaks â€” Secret detection in source code
# Install: brew install gitleaks (macOS) or docker run zricethezav/gitleaks
# Run: gitleaks detect --source . --verbose

title = "Gitleaks Config"

[allowlist]
  description = "Global allowlist"
  paths = [
    '''node_modules''',
    '''dist''',
    '''coverage''',
    '''.scannerwork''',
    '''package-lock.json''',
  ]

# Custom rules for the project
[[rules]]
  id = "hardcoded-password"
  description = "Hardcoded password in variable assignment"
  regex = '''(?i)(password|passwd|pwd|secret)\s*[:=]\s*['"][^\s'"]{8,}['"]'''
  tags = ["password", "hardcoded"]

[[rules]]
  id = "jwt-token"
  description = "JWT Token"
  regex = '''eyJ[A-Za-z0-9-_]+\.eyJ[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+'''
  tags = ["jwt", "token"]

[[rules]]
  id = "aws-access-key"
  description = "AWS Access Key ID"
  regex = '''AKIA[0-9A-Z]{16}'''
  tags = ["aws", "key"]

[[rules]]
  id = "generic-api-key"
  description = "Generic API Key"
  regex = '''(?i)(api[_-]?key|apikey)\s*[:=]\s*['"][A-Za-z0-9_\-]{20,}['"]'''
  tags = ["api", "key"]

[[rules]]
  id = "connection-string"
  description = "Database Connection String"
  regex = '''(?i)(mongodb|postgres|mysql|redis):\/\/[^\s'"]+:[^\s'"]+@[^\s'"]+'''
  tags = ["database", "connection"]

[[rules]]
  id = "private-key"
  description = "Private Key"
  regex = '''-----BEGIN (RSA |EC |DSA )?PRIVATE KEY-----'''
  tags = ["key", "private"]
