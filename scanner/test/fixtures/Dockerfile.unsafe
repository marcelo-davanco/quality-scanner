# Unsafe Dockerfile — should generate multiple findings in Trivy
# Used as a test fixture for the Infra Scan step

# ISSUE: Uses 'latest' tag (DS001)
FROM node:latest

# ISSUE: Uses ADD instead of COPY (DS005)
ADD . /app

WORKDIR /app

# ISSUE: Uses apt-get without --no-install-recommends and without clean (DS012, DS015)
RUN apt-get update && apt-get install -y curl wget git

# ISSUE: Uses sudo (DS014)
RUN sudo npm install -g pm2

RUN npm install

# ISSUE: Exposes privileged port (DS026)
EXPOSE 80

# ISSUE: No USER instruction — runs as root (DS002, DS013)
# ISSUE: No HEALTHCHECK (DS006)

CMD ["node", "index.js"]
